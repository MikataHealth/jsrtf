{"version":3,"sources":["webpack:///webpack/bootstrap c8af04930559a24dca83","webpack:///./node_modules/inherit/index.js","webpack:///./lib/format.js","webpack:///./lib/elements/element.js","webpack:///./lib/rtf-utils.js","webpack:///./lib/data/rgb.js","webpack:///./lib/data/fonts.js","webpack:///./lib/data/colors.js","webpack:///./lib/options.js","webpack:///./jsrtf.js","webpack:///(webpack)/buildin/module.js","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/inherit/lib/inherit.js","webpack:///./lib/index.js","webpack:///./lib/data/language.js","webpack:///./lib/data/options.js","webpack:///./lib/elements/container.js","webpack:///./lib/elements/text.js","webpack:///./lib/elements/table.js","webpack:///./lib/elements/group.js"],"names":["module","exports","require","RGB","Fonts","Colors","Utils","Options","inherit","wrap","text","prefix","postfix","Format","__constructor","options","Object","assign","defaultOptions","updateTables","colorTable","fontTable","fontPos","indexOf","font","undefined","length","push","obj","key","borderLeft","borderRight","borderTop","borderBottom","map","item","keyPos","getColorPosition","formatText","safeText","optionsStr","compile","getRTFSafeText","content","join","applyWrappers","Element","format","String","prototype","replaceAll","token","newToken","ignoreCase","str","toString","i","_token","toLowerCase","substring","concat","split","dpi","twipsPerMM","mm2twips","mm","Math","round","isIndex","index","isNaN","hasOwnProperty","safe","Error","createColorTable","table","c","rgb","red","green","blue","createFontTable","f","ARIAL","find","resultIndex","Array","isArray","color","COMIC_SANS","GEORGIA","IMPACT","TAHOMA","HELVETICA","VERDANA","COURIER_NEW","PALATINO","TIMES_NEW_ROMAN","BLACK","WHITE","RED","BLUE","LIME","YELLOW","MAROON","GREEN","GRAY","ORANGE","OptionsData","compare","a","b","order","max","makeIndex","x","ax","bx","result","sortKeys","optionsFirst","oprionsLast","_notEmptyKey","keys","filter","sort","ctx","name","test","call","value","reverse","reduce","lib","NL","jsRTF","elements","params","_getDefaultParams","marginLeft","marginRight","marginBottom","marginTop","language","Language","ENG_US","landscape","addPara","groupName","addCommand","addTable","addTextGroup","_groupIndex","formatGroup","GroupElement","addElement","element","ContainerElement","TextElement","writeText","command","addPage","addLine","addTab","addSection","addOptions","forEach","el","getRTFCode","createDocument","output","elemsContent","defineAsGlobal","modules","define","provide","window","global","jsrtf","webpackPolyfill","deprecate","paths","children","defineProperty","enumerable","get","l","g","Function","eval","e","hasIntrospection","emptyBase","objCreate","create","ptp","inheritance","objKeys","res","extend","o1","o2","toStr","isFunction","noOp","needCheckProps","testPropObj","specProps","getPropList","specProp","override","base","add","addList","j","len","prop","__self","baseMethod","__parent","baseSaved","__base","apply","arguments","applyMixins","mixins","mixin","self","args","withMixins","hasBase","props","staticProps","constructor","basePtp","resPtp","TableElement","SP_MX","FR","RU","NONE","borderTypes","single","doubleThickness","shadowed","double","dotted","dashed","hairline","dashSmall","dotDash","dotDotDash","triple","thickThinSmall","thinThickSmall","thinThickThinSmall","thickThinMedium","thinThickMedium","thinThickThinMedium","thickThinLarge","thinThickLarge","thinThickThinLarge","wavy","doubleWavy","striped","emboss","engrave","makeBorder","baseObject","id","data","spacing","width","type","v","colorPos","spaceBefore","spaceAfter","leftIndent","rightIndent","alignLeft","alignRight","alignCenter","alignFull","align","charAt","bgColor","bgColorPos","borderColor","borderColorPos","borderSpacing","borderWidth","borderType","fontSize","pageWidth","pageHeight","pageNumbering","columns","columnLines","paragraph","bold","italic","underline","strike","subScript","superScript","getItemRTFCode","rowFormat","cellsFormats","addRow","row","setData","columnsCount","rowContent","rowNo","tableFormat","firstRowFormat","cell","cellContent","n","cellFormat","rowPlus","lastRatio","tableHeader","tableBorder","ratio","widthPercents","widthRatio","tableWidth","updateFormats","formats","firstRowsFormat","fmt"],"mappings":"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","file":"jsrtf.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c8af04930559a24dca83","/*!\n * node-inherit\n * Copyright(c) 2011 Dmitry Filatov <dfilatov@yandex-team.ru>\n * MIT Licensed\n */\n\nmodule.exports = require('./lib/inherit');\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/inherit/index.js","/**\n * @module format\n * @overview Formating\n * @author lilliputten <igor@lilliputten.ru>\n */\n\nvar\n\n    RGB = require('./data/rgb'),\n    Fonts = require('./data/fonts'),\n    Colors = require('./data/colors'),\n\n    Utils = require('./rtf-utils'),\n    Options = require('./options'),\n\n    inherit = require('inherit')\n;\n\n/** wrap ** {{{ some RTF elements require that they are wrapped, closed by a trailing 0 and must have a spacebefore the text\n */\nfunction wrap (text, prefix, postfix) {\n    postfix = postfix || ( prefix + '0' );\n    return prefix + ' ' + text + postfix;\n}/*}}}*/\n\n/**\n * @class\n * @name Format\n */\nvar Format = inherit(/** @lends Format.prototype */{\n\n    /** __constructor ** {{{\n     * @param {Object} [options]\n     */\n    __constructor : function (options) {\n        Object.assign(this, Format.defaultOptions, options);\n    },/*}}}*/\n\n    /** updateTables ** {{{ */\n    updateTables : function (colorTable, fontTable) {\n\n        // font...\n        this.fontPos = fontTable.indexOf(this.font);\n        // if a font was defined, and it's not in a table, add it in!\n        if ( this.fontPos < 0 && this.font !== undefined && this.font ) {\n            this.fontPos = fontTable.length;\n            fontTable.push(this.font);\n        }\n\n        // colors...\n        [\n            { obj : this, key : 'color' },\n            { obj : this, key : 'bgColor' },\n            { obj : this, key : 'borderColor' },\n            { obj : this.borderLeft, key : 'color' },\n            { obj : this.borderRight, key : 'color' },\n            { obj : this.borderTop, key : 'color' },\n            { obj : this.borderBottom, key : 'color' },\n        ].map(item => {\n            var obj = item.obj, key = item.key;\n            if ( obj && typeof obj === 'object' && obj[key] ) {\n                var keyPos = key + 'Pos';\n                obj[keyPos] = Utils.getColorPosition(colorTable, obj[key]);\n                if ( obj[keyPos] < 0 && obj[key] ) {\n                    obj[keyPos] = colorTable.length;\n                    colorTable.push(obj[key]);\n                }\n            }\n        });\n\n    },/*}}}*/\n\n    /** formatText ** {{{ Applies a format to some text\n     * @param {String} text\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     * @param {Boolean} [safeText]\n     */\n    formatText : function (text, colorTable, fontTable, safeText) {\n\n        ( safeText === undefined ) && ( safeText = true );\n\n        this.updateTables(colorTable, fontTable);\n\n        var options = new Options(this);\n        var optionsStr = options.compile();\n\n        // we don't escape text if there are other elements in it, so set a flag\n        if ( safeText && typeof text === 'string' ){\n            text = Utils.getRTFSafeText(text);\n        }\n\n        var content = [ optionsStr, text ].join(' ');\n\n        content = options.applyWrappers(content);\n\n        return [ '\\{', content, '\\}' ].join('');\n\n    },/*}}}*/\n\n}, /*{{{ Static properties... *//** @lends Format */{\n\n    /** defaultOptions ** {{{\n     * @type {Object}\n     */\n    defaultOptions : {\n\n        // font: Fonts.ARIAL,\n\n    },/*}}}*/\n\n}/*}}}*/\n); // end inherit\n\nmodule.exports = Format;\n\n\n\n\n// WEBPACK FOOTER //\n// ./lib/format.js","/**\n * @module element\n * @overview Base element class\n * @author lilliputten <igor@lilliputten.ru>\n */\nvar\n    Format = require('../format'),\n    inherit = require('inherit')\n;\n\n// Function.prototype.subclass = function(base) {\n//     var c = Function.prototype.subclass.nonconstructor;\n//     c.prototype= base.prototype;\n//     this.prototype= new c ();\n// };\n// Function.prototype.subclass.nonconstructor = function() {};\n\nvar Element = inherit({\n\n    /** __constructor ** {{{ */\n    __constructor : function (format) {\n        if ( format === undefined ) {\n            format = new Format();\n        }\n        this.format = format;\n    },/*}}}*/\n\n});\n\nmodule.exports = Element;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/elements/element.js","/**\n * @module rtf-utils\n * @overview Misc utilities & helpers.\n * @author lilliputten <igor@lilliputten.ru>\n */\nvar\n    RGB = require('./data/rgb'),\n    Fonts = require('./data/fonts'),\n    inherit = require('inherit')\n;\n\n/** String.prototype.replaceAll ** {{{ Replaces all occurrences of a substring in a string\n * ReplaceAll by Fagner Brack (MIT Licensed)\n */\nString.prototype.replaceAll = function (token, newToken, ignoreCase) {\n    var str = this.toString(), i = -1, _token;\n    if(typeof token === \"string\") {\n        if(ignoreCase === true) {\n            _token = token.toLowerCase();\n            while((i = str.toLowerCase().indexOf( token, i >= 0? i + newToken.length : 0 )) !== -1 ) {\n                str = str.substring(0, i)\n                    .concat(newToken)\n                    .concat(str.substring(i + token.length));\n            }\n        } else {\n            return this.split(token).join(newToken);\n        }\n    }\n    return str;\n};/*}}}*/\n\nmodule.exports = {\n\n    dpi : 300,\n    twipsPerMM : 56.6925562674,\n\n    /** mm2twips ** {{{ Convert milimeters to twips\n     * @see {@link https://en.wikipedia.org/wiki/Twip}\n     * @see {@link http://www.convertunits.com/from/twip/to/mm}\n     * @returns {Integer}\n     */\n    mm2twips : function (mm) {\n        return Math.round( this.twipsPerMM * mm );\n    },/*}}}*/\n\n    /** isIndex ** {{{ Check is index is defined and positive (Number>=0)\n     * @returns {Boolean}\n     */\n    isIndex : function (index) {\n        return ( !isNaN(index) && index >= 0 );\n    },/*}}}*/\n\n    /** getRTFSafeText ** {{{ Makes text safe for RTF by escaping characters and it also converts linebreaks\n     * Also checks to see if safetext should be overridden by non-elements like \"\\line\"\n     */\n    getRTFSafeText : function (text){\n        //if text is overridden not to be safe\n        if ( typeof text === 'object' && text.hasOwnProperty('text') && text.hasOwnProperty('safe') && !text.safe ) {\n            return text.text;\n        }\n        else if ( typeof text === 'object' ) {\n            // console.log(' getRTFSafeText object', text );\n            throw new Error('Expecting text, not object');\n        }\n        //this could probably all be replaced by a bit of regex\n        return text.replaceAll('\\\\','\\\\\\\\')\n            .replaceAll('\\{','\\\\\\{')\n            .replaceAll('\\}','\\\\\\}')\n            .replaceAll('~','\\\\~')\n            .replaceAll('-','\\\\-')\n            .replaceAll('_','\\\\_')\n            //turns line breaks into \\line commands\n            .replaceAll('\\n\\r',' \\\\line ')\n            .replaceAll('\\n',' \\\\line ')\n            .replaceAll('\\r',' \\\\line ')\n        ;\n    },/*}}}*/\n\n    /** createColorTable ** {{{ Generates a color table */\n    createColorTable : function (colorTable) {\n        var table = '',\n             c;\n        table+='\\{\\\\colortbl;\\n';\n        for(c=0; c < colorTable.length; c++) {\n            var rgb = colorTable[c];\n            table+='\\\\red' + rgb.red + '\\\\green' + rgb.green + '\\\\blue' + rgb.blue + ';\\n';\n        }\n        table+='\\}';\n        return table;\n    },/*}}}*/\n\n    /** createFontTable ** {{{ Generates a font table */\n    createFontTable : function (fontTable) {\n        var table = '',\n                f;\n        table+='\\{\\\\fonttbl;\\n';\n        if(fontTable.length === 0) {\n            table+='\\{\\\\f0 ' + Fonts.ARIAL + '\\}\\n'; //if no fonts are defined, use arial\n        } else {\n            for(f=0;f<fontTable.length;f++) {\n                    table+='\\{\\\\f' + f + ' ' + fontTable[f] + '\\}\\n';\n            }\n        }\n        table+='\\}';\n        return table;\n    },/*}}}*/\n\n    /** getColorPosition ** {{{ find color position in table\n     * @param {Array} table\n     * @param {RGB} find\n     */\n    getColorPosition : function (table, find) {\n        var resultIndex = -1;\n        if ( Array.isArray(table) && find && find instanceof RGB ) {\n            table.map(function(color, index){\n                if ( color.red === find.red && color.green === find.green && color.blue === find.blue ) {\n                    resultIndex = index;\n                }\n            });\n        }\n        return resultIndex;\n    }/*}}}*/\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/rtf-utils.js","module.exports = function(red, green, blue){\n    this.red = red;\n    this.green = green;\n    this.blue = blue;\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/data/rgb.js","module.exports = {\n    ARIAL : 'Arial',\n    COMIC_SANS : 'Comic Sans MS',\n    GEORGIA : 'Georgia',\n    IMPACT : 'Impact',\n    TAHOMA : 'Tahoma',\n    HELVETICA : 'Helvetica',\n    VERDANA : 'Verdana',\n    COURIER_NEW : 'Courier New',\n    PALATINO : 'Palatino Linotype',\n    TIMES_NEW_ROMAN : 'Times New Roman'\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/data/fonts.js","var RGB = require('./rgb');\nmodule.exports = {\n    BLACK : new RGB(0,0,0),\n    WHITE : new RGB(255,255,255),\n    RED : new RGB(255,0,0),\n    BLUE : new RGB(0,0,255),\n    LIME : new RGB(191,255,0),\n    YELLOW : new RGB(255,255,0),\n    MAROON : new RGB(128,0,0),\n    GREEN : new RGB(0,255,0),\n    GRAY : new RGB(80,80,80),\n    ORANGE : new RGB(255,127,0)\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/data/colors.js","/**\n * @module options\n * @overview Options\n * @author lilliputten <igor@lilliputten.ru>\n */\nvar\n    OptionsData = require('./data/options'),\n    inherit = require('inherit')\n;\n\n/** compare ** {{{ */\nfunction compare (a, b, order) {\n    if ( !Array.isArray(order) ) { return 0; }\n    var\n        max = order.length,\n        makeIndex = (x) => ( x < 0 ) ? max : x,\n        ax = makeIndex(order.indexOf(a)),\n        bx = makeIndex(order.indexOf(b)),\n        result = ax - bx\n    ;\n    return result;\n}/*}}}*/\n/** sortKeys ** {{{ */\nfunction sortKeys (a, b) {\n    var result = compare(a, b, OptionsData.optionsFirst) - compare(a, b, OptionsData.oprionsLast);\n    return result;\n}/*}}}*/\n\nvar Options = inherit({\n\n    /** __constructor ** {{{ */\n    __constructor : function(format){\n        // this.format = format;\n        Object.assign(this, format);\n    },/*}}}*/\n\n    /** _notEmptyKey ** {{{ */\n    _notEmptyKey : function (key) {\n        return OptionsData.options[key] && this[key] !== undefined && this[key] !== null && this[key] !== false;\n    },/*}}}*/\n\n    /** compile ** {{{ */\n    compile : function () {\n        var result = Object.keys(this)\n            .filter(this._notEmptyKey, this)\n            .sort(sortKeys)\n            .map(key => {\n                var ctx = OptionsData.options[key];\n                if ( ctx === true ) {\n                    ctx = key;\n                }\n                if ( typeof ctx === 'string' ) {\n                    ctx = {\n                        key : key,\n                        name : ctx,\n                        prefix : '\\\\',\n                        // value = this[ctx.key],\n                    };\n                }\n                else {\n                    ctx = Object.assign({\n                            prefix : '\\\\',\n                            key : key,\n                            // value : this[ctx.key],\n                        }, ctx)\n                    ;\n                }\n                return ctx;\n            }, this)\n            .filter(ctx => !ctx.wrap)\n            .filter(ctx => typeof ctx.test !== 'function' || ctx.test.call(this, this[ctx.key]), this)\n            .map(ctx => {\n                var\n                    value = ( this[ctx.key] === true ) ? '' : this[ctx.key]\n                ;\n                if ( typeof ctx.value === 'function' ) {\n                    value = ctx.value.call(this, this[ctx.key]);\n                }\n                else if ( typeof ctx.value === 'object' && ctx.value[this[ctx.key]] ) {\n                    value = ctx.value[this[ctx.key]];\n                }\n                return [ ctx.prefix, ctx.name, value, ctx.postfix ].join('');\n            }, this)\n            .join('')\n        ;\n        return result;\n    },/*}}}*/\n\n    /** applyWrappers ** {{{ */\n    applyWrappers : function (value) {\n        var result = Object.keys(this)\n            .filter(key => typeof OptionsData.options[key] === 'object' && OptionsData.options[key].wrap)\n            .sort(sortKeys)\n            .reverse()\n            .map(key => {\n                var ctx = OptionsData.options[key];\n                ctx = Object.assign({\n                        key : key,\n                        prefix : '\\\\'+ctx.name,\n                        postfix : '\\\\'+ctx.name+'0',\n                        // value : this[ctx.key],\n                    }, ctx)\n                ;\n                return ctx;\n            }, this)\n            .filter(ctx => typeof ctx.test !== 'function' || ctx.test.call(this, value), this)\n            .reduce((value,ctx,i) => {\n                if ( !i ) {\n                    value = ' ' + value;\n                }\n                return [ ctx.prefix, value, ctx.postfix ].join('');\n            }, value)\n        ;\n        return result;\n    },/*}}}*/\n\n});\n\nmodule.exports = Options;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/options.js","/* globals window, define, exports, module, modules */\n/**\n *\n * @module jsRTF\n * @overview Library for making rich text documents\n * @author lilliputten <igor@lilliputten.ru>\n *\n * Original maintainer Jonathan Rowny (https://github.com/jrowny/node-rtf)\n *\n */\n\nvar\n    inherit = require('inherit'),\n    lib = require('./lib/index'),\n    isArray = Array.isArray,\n    NL = '\\n'\n;\n\n/**\n * @class\n * @name jsRTF\n */\nvar jsRTF = inherit(/** @lends jsRTF.prototype */{\n\n    // Data...\n\n    /** Stores the elements */\n    elements: [],\n\n    /** Stores the colors */\n    colorTable: [],\n\n    /** Stores the fonts */\n    fontTable: [],\n\n    // Methods...\n\n    /** __constructor ** {{{\n     * @param {Object} [params] - Optional parameters of document\n     */\n    __constructor : function (params) {\n        // params...\n        this.params = this.params || {};\n        if ( typeof this._getDefaultParams === 'function' ) {\n            Object.assign(this.params, this._getDefaultParams());\n        }\n        Object.assign(this.params, params);\n    },/*}}}*/\n\n    /** _getDefaultParams ** {{{ */\n    _getDefaultParams : function () {\n        return {\n\n            // pageNumbering: false,\n            marginLeft: 1800,\n            marginRight: 1800,\n            marginBottom: 1440,\n            marginTop: 1440,\n\n            language: jsRTF.Language.ENG_US,\n\n            // columns: 0,//columns?\n            // columnLines: false,//lines between columns\n            // orientation: jsRTF.Orientation.PORTRAIT,\n            landscape : true,\n\n        };\n    },/*}}}*/\n\n    /** addPara ** {{{ Add paragraph break command (???)\n     * @param {Object} [options]\n     * @param {String} [groupName]\n     */\n    addPara : function (options, groupName) {\n        this.addCommand('\\n\\\\par', groupName, options);\n    },/*}}}*/\n\n    /** addTable ** {{{\n     * TODO: not sure why this function exists... probably to validate incoming tables later on\n     */\n    addTable : function (table) {\n        this.elements.push(table);\n    },/*}}}*/\n\n    /** addTextGroup ** {{{ */\n    addTextGroup : function (name, format) {\n        if(this._groupIndex(name)<0) {//make sure we don't have duplicate groups!\n            var formatGroup = new jsRTF.GroupElement(name, format);\n            this.elements.push(formatGroup);\n        }\n    },/*}}}*/\n\n    /** addElement ** {{{ adds a single element to a given group or as an element\n     * @param {Object|Array} element\n     * @param {String} [groupName]\n     * @param {Object} [options]\n     * TODO this should not be in prototype (NOTE: from maintainer?)\n     */\n    addElement : function (element, groupName, options) {\n\n        // Check for `(command, options)` passed...\n        if ( options === undefined && typeof groupName === 'object' ) {\n            options = groupName;\n            groupName = undefined;\n        }\n\n        if ( !element ) {\n            throw new Error('Element not defined');\n        }\n        else if ( isArray(element) ) {\n            element = new lib.ContainerElement(element, options);\n        }\n        else if ( typeof element === 'string' || typeof element === 'number' ) {\n            element = new lib.TextElement(element, options);\n        }\n\n        // Original code...\n        if ( groupName !== undefined && this._groupIndex(groupName)>=0 ) {\n            this.elements[this._groupIndex(groupName)].addElement(element);\n        }\n        else {\n            this.elements.push(element);\n        }\n\n    },/*}}}*/\n\n    /** writeText ** {{{ */\n    writeText : function (text, format, groupName) {\n        var element = new jsRTF.TextElement(text, format);\n        this.addElement(element, groupName);\n    },/*}}}*/\n\n    /** addCommand ** {{{ adds a single command to a given group or as an element\n     * @param {String} command\n     * @param {String} [groupName]\n     * @param {Object} [options]\n     * TODO this should not be in prototype (NOTE: from maintainer?)\n     */\n    addCommand : function (command, groupName, options) {\n\n        if ( !command ) {\n            throw new Error('Command not defined');\n        }\n\n        // Check for `(command, options)` passed...\n        if ( options === undefined && typeof groupName === 'object' ) {\n            options = groupName;\n            groupName = undefined;\n        }\n\n        // If options, then adding them to command\n        if ( options && typeof options === 'object' ) {\n            if ( options instanceof lib.Format ) {\n                options.updateTables(this.colorTable, this.fontTable);\n            }\n            command +=  ( new jsRTF.Options(options) ).compile();\n        }\n\n        var element = {\n            text : command,\n            safe : false,\n        };\n\n        return this.addElement(element);\n\n    },/*}}}*/\n\n    /** addPage ** {{{ page break shortcut */\n    addPage : function (groupName) {\n        this.addCommand('\\\\page', groupName);\n    },/*}}}*/\n\n    /** addLine ** {{{ line break shortcut */\n    addLine : function (groupName) {\n        this.addCommand('\\\\line', groupName);\n    },/*}}}*/\n\n    /** addTab ** {{{ tab shortcut */\n    addTab : function (groupName) {\n        this.addCommand('\\\\tab', groupName);\n    },/*}}}*/\n\n    /** addSection ** {{{ Adds section\n     * @param {Object} [options]\n     * @param {String} [groupName]\n     */\n    addSection : function (options, groupName) {\n        this.addCommand('\\\\sect', groupName, options);\n    },/*}}}*/\n\n    /** addOptions ** {{{ Adds options (or styles) ???\n     * @param {Object} options\n     * @param {String} [groupName]\n     */\n    addOptions : function (options, groupName) {\n        if ( !options ) {\n            throw new Error('Options not defined');\n        }\n        if ( options && options instanceof lib.Format ) {\n            options.updateTables(this.colorTable, this.fontTable);\n        }\n        var command = ( new jsRTF.Options(options) ).compile();\n        if ( command ) {\n            this.addCommand(command, groupName);\n        }\n    },/*}}}*/\n\n    /** _groupIndex ** {{{ gets the index of a group\n     * TODO: make this more private by removing it from prototype and passing elements\n     */\n    _groupIndex : function (name) {\n        this.elements.forEach(function(el, i){\n            if ( el instanceof jsRTF.GroupElement && el.name===name ) {\n                return i;\n            }\n        });\n        return -1;\n    },/*}}}*/\n\n    /** getRTFCode ** {{{ */\n    getRTFCode : function (item) {\n\n        var result = '';\n\n        if ( isArray(item) ) {\n            result = item\n                .map(this.getRTFCode, this)\n                .join('\\n')\n            ;\n        }\n        else if ( item instanceof jsRTF.Element ) {\n            result = item.getRTFCode(this.colorTable, this.fontTable);\n        }\n        else {\n            result = jsRTF.Utils.getRTFSafeText(item);\n        }\n\n        return result;\n\n    },/*}}}*/\n\n    /** createDocument ** {{{ */\n    createDocument : function () {\n\n        // Opening document sequence\n        var output = '\\{\\\\rtf1\\\\ansi\\\\deff0\\n';\n\n        // Document parameters\n        var options = new jsRTF.Options(this.params);\n        output += options.compile() + NL;\n\n        // Creating content\n        var elemsContent = this.getRTFCode(this.elements);\n\n        //now that the tasks are done running: create tables, data populated during element output\n        output += jsRTF.Utils.createColorTable(this.colorTable) + NL;\n        output += jsRTF.Utils.createFontTable(this.fontTable) + NL;\n\n        // Finishing document\n        output += elemsContent + '\\n\\}';\n\n        return output;\n\n    },/*}}}*/\n\n},\n\n/* Static properties... {{{ *//** @lends jsRTF */lib\n/*}}}*/\n\n);\n\n/*{{{ Provide... */\n\nvar defineAsGlobal = true;\n\n// Provide with CommonJS\nif ( typeof module === 'object' && typeof module.exports === 'object' ) {\n    module.exports = jsRTF;\n    defineAsGlobal = false;\n}\n\n// Provide to YModules\nif ( typeof modules === 'object' ) {\n    modules.define('jsrtf', function(provide) {\n        provide(jsRTF);\n    });\n    defineAsGlobal = false;\n}\n\n// Provide to global scope\nif ( defineAsGlobal ) {\n    ( typeof window !== 'undefined' ? window : global ).jsrtf = jsRTF;\n}\n\n/*}}}*/\n\n\n\n\n// WEBPACK FOOTER //\n// ./jsrtf.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/module.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","/**\n * @module inherit\n * @version 2.2.6\n * @author Filatov Dmitry <dfilatov@yandex-team.ru>\n * @description This module provides some syntax sugar for \"class\" declarations, constructors, mixins, \"super\" calls and static members.\n */\n\n(function(global) {\n\nvar hasIntrospection = (function(){return '_';}).toString().indexOf('_') > -1,\n    emptyBase = function() {},\n    hasOwnProperty = Object.prototype.hasOwnProperty,\n    objCreate = Object.create || function(ptp) {\n        var inheritance = function() {};\n        inheritance.prototype = ptp;\n        return new inheritance();\n    },\n    objKeys = Object.keys || function(obj) {\n        var res = [];\n        for(var i in obj) {\n            hasOwnProperty.call(obj, i) && res.push(i);\n        }\n        return res;\n    },\n    extend = function(o1, o2) {\n        for(var i in o2) {\n            hasOwnProperty.call(o2, i) && (o1[i] = o2[i]);\n        }\n\n        return o1;\n    },\n    toStr = Object.prototype.toString,\n    isArray = Array.isArray || function(obj) {\n        return toStr.call(obj) === '[object Array]';\n    },\n    isFunction = function(obj) {\n        return toStr.call(obj) === '[object Function]';\n    },\n    noOp = function() {},\n    needCheckProps = true,\n    testPropObj = { toString : '' };\n\nfor(var i in testPropObj) { // fucking ie hasn't toString, valueOf in for\n    testPropObj.hasOwnProperty(i) && (needCheckProps = false);\n}\n\nvar specProps = needCheckProps? ['toString', 'valueOf'] : null;\n\nfunction getPropList(obj) {\n    var res = objKeys(obj);\n    if(needCheckProps) {\n        var specProp, i = 0;\n        while(specProp = specProps[i++]) {\n            obj.hasOwnProperty(specProp) && res.push(specProp);\n        }\n    }\n\n    return res;\n}\n\nfunction override(base, res, add) {\n    var addList = getPropList(add),\n        j = 0, len = addList.length,\n        name, prop;\n    while(j < len) {\n        if((name = addList[j++]) === '__self') {\n            continue;\n        }\n        prop = add[name];\n        if(isFunction(prop) &&\n                (!prop.prototype || !prop.prototype.__self) && // check to prevent wrapping of \"class\" functions\n                (!hasIntrospection || prop.toString().indexOf('.__base') > -1)) {\n            res[name] = (function(name, prop) {\n                var baseMethod = base[name]?\n                        base[name] :\n                        name === '__constructor'? // case of inheritance from plain function\n                            res.__self.__parent :\n                            noOp,\n                    result = function() {\n                        var baseSaved = this.__base;\n\n                        this.__base = result.__base;\n                        var res = prop.apply(this, arguments);\n                        this.__base = baseSaved;\n\n                        return res;\n                    };\n                result.__base = baseMethod;\n\n                return result;\n            })(name, prop);\n        } else {\n            res[name] = prop;\n        }\n    }\n}\n\nfunction applyMixins(mixins, res) {\n    var i = 1, mixin;\n    while(mixin = mixins[i++]) {\n        res?\n            isFunction(mixin)?\n                inherit.self(res, mixin.prototype, mixin) :\n                inherit.self(res, mixin) :\n            res = isFunction(mixin)?\n                inherit(mixins[0], mixin.prototype, mixin) :\n                inherit(mixins[0], mixin);\n    }\n    return res || mixins[0];\n}\n\n/**\n* Creates class\n* @exports\n* @param {Function|Array} [baseClass|baseClassAndMixins] class (or class and mixins) to inherit from\n* @param {Object} prototypeFields\n* @param {Object} [staticFields]\n* @returns {Function} class\n*/\nfunction inherit() {\n    var args = arguments,\n        withMixins = isArray(args[0]),\n        hasBase = withMixins || isFunction(args[0]),\n        base = hasBase? withMixins? applyMixins(args[0]) : args[0] : emptyBase,\n        props = args[hasBase? 1 : 0] || {},\n        staticProps = args[hasBase? 2 : 1],\n        res = props.__constructor || (hasBase && base.prototype && base.prototype.__constructor)?\n            function() {\n                return this.__constructor.apply(this, arguments);\n            } :\n            hasBase?\n                function() {\n                    return base.apply(this, arguments);\n                } :\n                function() {};\n\n    if(!hasBase) {\n        res.prototype = props;\n        res.prototype.__self = res.prototype.constructor = res;\n        return extend(res, staticProps);\n    }\n\n    extend(res, base);\n\n    res.__parent = base;\n\n    var basePtp = base.prototype,\n        resPtp = res.prototype = objCreate(basePtp);\n\n    resPtp.__self = resPtp.constructor = res;\n\n    props && override(basePtp, resPtp, props);\n    staticProps && override(base, res, staticProps);\n\n    return res;\n}\n\ninherit.self = function() {\n    var args = arguments,\n        withMixins = isArray(args[0]),\n        base = withMixins? applyMixins(args[0], args[0][0]) : args[0],\n        props = args[1],\n        staticProps = args[2],\n        basePtp = base.prototype;\n\n    props && override(basePtp, basePtp, props);\n    staticProps && override(base, base, staticProps);\n\n    return base;\n};\n\nvar defineAsGlobal = true;\nif(typeof exports === 'object') {\n    module.exports = inherit;\n    defineAsGlobal = false;\n}\n\nif(typeof modules === 'object' && typeof modules.define === 'function') {\n    modules.define('inherit', function(provide) {\n        provide(inherit);\n    });\n    defineAsGlobal = false;\n}\n\nif(typeof define === 'function') {\n    define(function(require, exports, module) {\n        module.exports = inherit;\n    });\n    defineAsGlobal = false;\n}\n\ndefineAsGlobal && (global.inherit = inherit);\n\n})(this);\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/inherit/lib/inherit.js","/**\n * @module index\n * @overview Export library interface\n * @author lilliputten <igor@lilliputten.ru>\n */\nmodule.exports = {\n\n    Utils : require('./rtf-utils'),\n\n    Fonts : require('./data/fonts'),\n    Colors : require('./data/colors'),\n    RGB : require('./data/rgb'),\n    Language : require('./data/language'),\n\n    Format : require('./format'),\n\n    Element : require('./elements/element'),\n\n    ContainerElement : require('./elements/container'),\n    TextElement : require('./elements/text'),\n    TableElement : require('./elements/table'),\n    GroupElement : require('./elements/group'),\n    // ImageElement : require('./elements/image'),\n\n    Options : require('./options'),\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/index.js","module.exports = {\n    ENG_US : 1033,\n    SP_MX : 2058,\n    FR : 1036,\n    RU : 1049,\n    NONE : 1024\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/data/language.js","/**\n * @module options-data\n * @overview Definitions of rtf options\n * @author lilliputten <igor@lilliputten.ru>\n */\n\nvar\n    /** borderTypes ** {{{\n     * @type {Object}\n     */\n    borderTypes = {\n        single : 's',\n        doubleThickness : 'th',\n        shadowed : 'sh',\n        double : 'db',\n        dotted : 'dot',\n        dashed : 'dash',\n        hairline : 'hair',\n        dashSmall : 'dashsm',\n        dotDash : 'dashd',\n        dotDotDash : 'dashdd',\n        triple : 'triple',\n        thickThinSmall : 'tnthsg',\n        thinThickSmall : 'thtnsg',\n        thinThickThinSmall : 'tnthtnsg',\n        thickThinMedium : 'tnthmg',\n        thinThickMedium : 'thtnmg',\n        thinThickThinMedium : 'tnthtnmg',\n        thickThinLarge : 'tnthlg',\n        thinThickLarge : 'thtnlg',\n        thinThickThinLarge : 'tnthtnlg',\n        wavy : 'wavy',\n        doubleWavy : 'wavydb',\n        striped : 'dashdotstr',\n        emboss : 'emboss',\n        engrave : 'engrave',\n    },/*}}}*/\n    /** makeBorder ** {{{ Create border\n     * @type {Function}\n     * @param {Object} baseObject - Parent Format or Options object\n     * @param {String} id - Border property id (eg 'borderLeft')\n     * @param {Object} data - Border descriptions hash\n     * @returns {String}\n     */\n    makeBorder = function (baseObject, id, data) {\n        var options = {\n                spacing : 'brsp', // border spacing\n                width : 'brdrw', // border spacing\n                // border type\n                type : { name : 'brdr', value : borderTypes },\n                // color\n                color : { name : 'brdrcf', value : (v) => {\n                    return baseObject[id].colorPos + 1;\n                } }\n            },\n            result = Object.keys(data)\n                .filter(key => data[key] !== undefined && options[key] !== undefined)\n                .map(key => {\n                    var value = data[key];\n                    var result = options[key];\n                    if ( typeof result === 'object' && result.name ) {\n                        if ( typeof result.value === 'object' && result.value[value] !== undefined ) {\n                            value = result.value[value];\n                            result = result.name;\n                        }\n                        else if ( typeof result.value === 'function' ) {\n                            value = result.value.call(baseObject, value);\n                            result = result.name;\n                        }\n                    }\n                    return '\\\\' + result + value;\n                })\n                .join('')\n        ;\n        return result;\n    }/*}}}*/\n;\n\nmodule.exports = {\n\n    /** options ** {{{ List of all entities */\n    options : {\n\n        spaceBefore : 'sb',\n        spaceAfter : 'sa',\n        leftIndent : 'li',\n        rightIndent : 'ri',\n\n        alignLeft : 'ql',\n        alignRight : 'qr',\n        alignCenter : 'qc',\n        alignFull : 'qj',\n        align : { name : 'q', value : (v) => String(v).toLowerCase().charAt(0) }, // 'center' => 'qc', 'left' => 'ql' etc...\n\n        // fontPos : { name : 'f', test : (v) => v >= 0 },\n        // colorPos : { name : 'cf', test : (v) => v >= 0 },\n        // bgColorPos : { name : 'cb', test : (v) => v >= 0, value : (v) => isNaN(v) ? v : String( v + 1 ) },\n\n        font : { name : 'f', test : v => v, value : function (v) { return this.fontPos; } }, // NOTE: using non-arrow function for catch `this` value\n        color : { name : 'cf', test : v => v, value : function (v) { return this.colorPos + 1; } }, // NOTE: using non-arrow function for catch `this` value\n        bgColor : { name : 'cb', test : v => v, value : function (v) { return this.bgColorPos + 1; } }, // NOTE: using non-arrow function for catch `this` value\n        borderColor : { name : 'brdrcf', test : v => v, value : function (v) { return this.borderColorPos + 1; } }, // NOTE: using non-arrow function for catch `this` value\n\n        // custom borders\n        borderLeft : { name : 'brdrl', value : function(v) { return makeBorder(this, 'borderLeft', v); } },\n        borderRight : { name : 'brdrr', value : function(v) { return makeBorder(this, 'borderRight', v); } },\n        borderTop : { name : 'brdrt', value : function(v) { return makeBorder(this, 'borderTop', v); } },\n        borderBottom : { name : 'brdrb', value : function(v) { return makeBorder(this, 'borderBottom', v); } },\n\n        // common border properties (may be overriden by borderLeft etc)\n        borderSpacing : 'brsp', // border spacing\n        borderWidth : 'brdrw', // border spacing\n        // border type\n        borderType : { name : 'brdr', value : borderTypes },\n\n        // tableHeader : 'trhdr',\n\n        // makeParagraph : 'pard',\n        fontSize : { name : 'fs', value : (v) => isNaN(v) ? v : v * 2 },\n\n        landscape : 'lndscpsxn', // ???\n\n        pageWidth : 'pgwsxn',\n        pageHeight : 'pghsxn',\n\n        marginLeft : 'margl',\n        marginRight : 'margr',\n        marginTop : 'margt',\n        marginBottom : 'margb',\n        language : 'deflang',\n\n        pageNumbering : { prefix : '', value : '\\{\\\\header\\\\pard\\\\qr\\\\plain\\\\f0\\\\chpgn\\\\par\\}' },\n        columns : 'cols',\n        columnLines : 'linebetcol',\n\n        paragraph : { wrap : true, prefix : '\\\\pard', postfix : '\\\\par' },\n\n        bold : { wrap : true, prefix : '\\\\b', postfix : '\\\\b0' },\n        italic : { wrap : true, prefix : '\\\\i', postfix : '\\\\i0' },\n        underline : { wrap : true, prefix : '\\\\ul', postfix : '\\\\ul0' },\n        strike : { wrap : true, prefix : '\\\\strike', postfix : '\\\\strike0' },\n        subScript : { wrap : true, prefix : '\\\\sub', postfix : '\\\\sub0' },\n        superScript : { wrap : true, prefix : '\\\\super', postfix : '\\\\super0' },\n    },/*}}}*/\n\n    /** optionsFirst ** {{{ Entities sort order: first items */\n    optionsFirst : [\n        'paragraph',\n\n        // // make border type first\n        // 'borderTop',\n        // 'borderBottom',\n        // 'borderLeft',\n        // 'borderRight',\n        // 'borderSpacing',\n        // 'borderWidth',\n        // 'borderType',\n        // 'borderColor',\n    ],/*}}}*/\n    /** oprionsLast ** {{{ Entities sort order: last items */\n    oprionsLast : [\n        'bold',\n        'italic',\n        'underline',\n        'strike',\n        'subScript',\n        'superScript',\n    ],/*}}}*/\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./lib/data/options.js","/**\n * @module container\n * @overview Container element class\n * @author lilliputten <igor@lilliputten.ru>\n */\nvar\n    Element = require('./element'),\n    Format = require('../format'),\n    inherit = require('inherit'),\n\n    isArray = Array.isArray\n;\n\nvar ContainerElement = inherit(Element, {\n\n    /** __constructor ** {{{ */\n    __constructor : function(data, format){\n        // Element.apply(this, [format]);\n        this.__base.call(this, format);\n        if ( this.format && typeof this.format === 'object' && !(this.format instanceof Format) ) {\n            this.format = new Format(this.format);\n        }\n        this.data = data;\n    },/*}}}*/\n\n    /** getItemRTFCode ** {{{ Get single object rtf code\n     * @param {*} item\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     * @returns {String}\n     */\n    getItemRTFCode : function (item, colorTable, fontTable) {\n\n        var result = '';\n\n        if ( isArray(item) ) {\n            result = item\n                .map(item => this.getItemRTFCode(item, colorTable, fontTable))\n                .join('\\n')\n            ;\n        }\n        else if ( item instanceof Element ) {\n            result = item.getRTFCode(colorTable, fontTable);\n        }\n        else {\n            result = this.format.formatText(item, colorTable, fontTable);\n        }\n\n        return result;\n\n    },/*}}}*/\n\n    /** getRTFCode ** {{{ Get element rtf code\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     * @returns {String}\n     */\n    getRTFCode : function(colorTable, fontTable){\n\n        var data = this.getItemRTFCode(this.data, colorTable, fontTable);\n\n        data = this.format.formatText(data, colorTable, fontTable, false);\n\n        return data;\n\n    },/*}}}*/\n\n});\n\nmodule.exports = ContainerElement;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/elements/container.js","/**\n * @module text\n * @overview Text element class\n * @author lilliputten <igor@lilliputten.ru>\n */\nvar\n    Element = require('./element'),\n    Format = require('../format'),\n    inherit = require('inherit')\n;\n\nvar TextElement = inherit(Element, {\n\n    /** __constructor ** {{{ */\n    __constructor : function(text, format){\n        // Element.apply(this, [format]);\n        this.__base.call(this, format);\n        if ( this.format && typeof this.format === 'object' && !(this.format instanceof Format) ) {\n            this.format = new Format(this.format);\n        }\n        this.text = text;\n    },/*}}}*/\n\n    /** getRTFCode ** {{{ */\n    getRTFCode : function(colorTable, fontTable){\n        return this.format.formatText(this.text, colorTable, fontTable);\n    },/*}}}*/\n\n});\n\nmodule.exports = TextElement;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/elements/text.js","/**\n * @module table\n * @overview Table element class\n * @author lilliputten <igor@lilliputten.ru>\n */\n\nvar\n    Utils = require('../rtf-utils'),\n    Format = require('../format'),\n\n    Element = require('./element'),\n    inherit = require('inherit'),\n\n    isArray = Array.isArray\n;\n\nvar TableElement = inherit(Element, {\n\n    /** __constructor ** {{{\n     * @param {Object} options\n     * @param {Object} [options.format]\n     * @param {Object} [options.rowFormat]\n     * @param {Object} [options.firstRowFormat]\n     * @param {Object[]} [options.cellsFormats]\n     */\n    __constructor : function (options) {\n        this.__base.apply(this, arguments);\n        this.data = [];\n        Object.assign(this, options);\n        this.data || ( this.data = [] );\n        this.format || ( this.format = new Format () );\n        this.rowFormat || ( this.rowFormat = new Format () );\n        this.cellsFormats || ( this.cellsFormats = [] );\n    },/*}}}*/\n\n    /** addRow ** {{{ Append one row data\n     */\n    addRow : function(row){\n        this.data.push(row);\n    },/*}}}*/\n\n    /** setData ** {{{ Set all table data\n     */\n    setData : function(data){\n        this.data = data;\n    },/*}}}*/\n\n    /** columnsCount ** {{{ Calculate columns count (max columns count in all rows)\n     */\n    columnsCount : function () {\n        var max = this.data.reduce((max, row) => Math.max(max, row.length), 0);\n        return max;\n    },/*}}}*/\n\n    /** rowContent ** {{{ Get row content\n     * @param {Array} row - Row data\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     * @returns {String}\n     */\n    rowContent : function (row, rowNo, colorTable, fontTable) {\n        var columnsCount = row.length;\n        var tableFormat = this.format;\n        var rowFormat = ( rowNo || !this.firstRowFormat ) ? this.rowFormat : this.firstRowFormat;\n        var rowContent = row\n            .map(cell => ( cell instanceof Element ) ? cell.getRTFCode(colorTable, fontTable) : Utils.getRTFSafeText(cell) )\n            .map((cellContent,n) => {\n                var cellFormat = this.cellsFormats[n];\n                if ( cellFormat ) {\n                    cellContent = cellFormat.formatText(cellContent, colorTable, fontTable, false);\n                }\n                return cellContent;\n            })\n            .map(cellContent => cellContent + '\\\\cell')\n            .join(' ')\n        ;\n        rowContent = rowFormat.formatText(rowContent, colorTable, fontTable, false);\n        var rowPlus = '\\{\\\\trowd\\\\trautofit1\\\\intbl';\n        var lastRatio = 0;\n        row.map((cell,n) => {\n            if ( rowFormat.tableHeader ) {\n                rowPlus += '\\\\trhdr';\n            }\n            if ( tableFormat.tableBorder ) {\n                rowPlus += [\n                    '',\n                    // TODO: border type, color?\n                    '\\\\clbrdrt\\\\brdrs\\\\brdrw' + tableFormat.tableBorder,\n                    '\\\\clbrdrb\\\\brdrs\\\\brdrw' + tableFormat.tableBorder,\n                    '\\\\clbrdrl\\\\brdrs\\\\brdrw' + tableFormat.tableBorder,\n                    '\\\\clbrdrr\\\\brdrs\\\\brdrw' + tableFormat.tableBorder,\n                ].join('\\n');\n            }\n            var cellFormat = this.cellsFormats[n];\n            var bgColorPos = ( cellFormat && Utils.isIndex(cellFormat.bgColorPos) ) ? cellFormat.bgColorPos : rowFormat.bgColorPos;\n            if ( Utils.isIndex(bgColorPos) ) {\n                rowPlus += '\\n\\\\clcbpat' + ( bgColorPos + 1 );\n            }\n            // Evaluate cell width\n            // TODO: Normalize cells widths?\n            var width;\n            if ( cellFormat && cellFormat.width ) {\n                width = cellFormat.width;\n            }\n            else {\n                var ratio = ( n + 1 ) / columnsCount;\n                if ( cellFormat && cellFormat.widthPercents ) {\n                    ratio = lastRatio + cellFormat.widthPercents / 100;\n                }\n                if ( cellFormat && cellFormat.widthRatio ) {\n                    ratio = lastRatio + cellFormat.widthRatio;\n                }\n                lastRatio = ratio;\n                width = Math.round( tableFormat.tableWidth ? tableFormat.tableWidth * ratio : columnsCount * ratio );\n            }\n            rowPlus += '\\n\\\\cellx' + width;\n        });\n        rowPlus += '\\n\\\\row\\}';\n        rowContent += '\\n' + rowPlus;\n        return rowContent;\n    },/*}}}*/\n\n    /** updateFormats ** {{{ Update all using formats\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     */\n    updateFormats : function (colorTable, fontTable) {\n\n        var formats = ( this.cellsFormats || [] ).concat([\n            this.format,\n            this.rowFormat,\n            this.firstRowsFormat,\n        ]);\n\n        formats\n            .filter(fmt => fmt)\n            .map(fmt => fmt.updateTables(colorTable, fontTable))\n        ;\n\n    },/*}}}*/\n\n    /** getRTFCode ** {{{ Get rtf content for entire table\n     * @param {Object} colorTable\n     * @param {Object} fontTable\n     * @returns {String}\n     */\n    getRTFCode : function (colorTable, fontTable) {\n\n        this.updateFormats(colorTable, fontTable);\n\n        var content = this.data\n            .filter(row => isArray(row))\n            .map((row,rowNo) => this.rowContent(row, rowNo, colorTable, fontTable), this)\n            .join('\\n')\n        ;\n\n        return content;\n\n    },/*}}}*/\n\n}); // end inherit\n\nmodule.exports = TableElement;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/elements/table.js","/**\n * @module table\n * @overview Table element class\n * @author lilliputten <igor@lilliputten.ru>\n */\n\nvar Utils = require('../rtf-utils'),\n    // async = require('async'),\n    Element = require('./element'),\n    inherit = require('inherit')\n;\n\nvar GroupElement = inherit(Element, {\n\n    /** __constructor ** {{{ */\n    __constructor : function(name, format) {\n        this.__base.call(this, format);\n        this.elements = [];\n        this.name = name;\n    },/*}}}*/\n\n    /** addElement ** {{{ */\n    addElement : function(element){\n        this.elements.push(element);\n    },/*}}}*/\n\n    /** getRTFCode ** {{{ */\n    getRTFCode : function(colorTable, fontTable/* , callback */){\n        var content = this.elements\n            .map(el => ( el instanceof Element ) ? el.getRTFCode(colorTable, fontTable) : Utils.getRTFSafeText(el))\n            .join('\\n')\n        ;\n        content = this.format.formatText(content, colorTable, fontTable, false);\n        return content;\n    },/*}}}*/\n\n});\n\nmodule.exports = GroupElement;\n\n\n\n// WEBPACK FOOTER //\n// ./lib/elements/group.js"],"sourceRoot":""}